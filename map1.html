<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"/>
<meta name="viewport" content="width=device-width"/>

<title>Startup Lab Lagoon</title>

<link rel="apple-touch-icon" href="app-icon.png"/>
<meta property="og:image" content="ogp-image.jpg"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
<script src="https://code4fukui.github.io/egmapjs/egmap.js"></script>
<link rel="stylesheet" href="https://code4fukui.github.io/egmapjs/egmap.css"/>
<script src="https://fukuno.jig.jp/fukuno.js"></script>
<script src="https://code4fukui.github.io/egmapjs/sparql.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script>"use strict"

window.onload = function() {
	var map = initMap('mapid')
	map.setZoom(18)

	var current = map.addIcon(0, 0, "現在地", "icon/lagoon.png", 64, 64)
	navigator.geolocation.watchPosition(function(gpos) {
		const base = 1000000
		// const pos = [ gpos.coords.latitude, gpos.coords.longitude ]
		const pos = [ 26.33676, 127.800403 ]
		current.setLatLng(pos)
		map.panTo(pos)
		console.log(Math.round(gpos.coords.latitude * base) / base)
		console.log(Math.round(gpos.coords.longitude * base) / base)
		var url = 'https://api.ottop.org/transit/stops?origin_latitude=' + (Math.round(gpos.coords.latitude * base) / base) + '&origin_longitude=' + (Math.round(gpos.coords.longitude * base) / base) + '&distance=1';
		const data = '[
  {
    "id": "S2903",
    "lat": 26.330451,
    "lng": 127.795982,
    "name": "園田",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S2903/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S2903/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4851",
    "lat": 26.334099,
    "lng": 127.804453,
    "name": "中部興産　沖縄市役所　前",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4851/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4851/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4842",
    "lat": 26.336874,
    "lng": 127.795524,
    "name": "クラウンホテル",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4842/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4842/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S2989",
    "lat": 26.337617,
    "lng": 127.806564,
    "name": "嘉間良",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S2989/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S2989/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S3227",
    "lat": 26.336201,
    "lng": 127.800681,
    "name": "胡屋",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S3227/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S3227/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S3912",
    "lat": 26.333218,
    "lng": 127.798748,
    "name": "中の町",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S3912/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S3912/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4837",
    "lat": 26.337217,
    "lng": 127.799145,
    "name": "一番街・サンシティ",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4837/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4837/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4846",
    "lat": 26.337497,
    "lng": 127.800481,
    "name": "コザ信用金庫　胡屋支店　前",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4846/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4846/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S2904",
    "lat": 26.330151,
    "lng": 127.795949,
    "name": "園田",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S2904/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S2904/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4845",
    "lat": 26.333193,
    "lng": 127.791383,
    "name": "コザ運動公園",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4845/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4845/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S2988",
    "lat": 26.337484,
    "lng": 127.807414,
    "name": "嘉間良",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S2988/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S2988/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S3226",
    "lat": 26.335701,
    "lng": 127.800598,
    "name": "胡屋",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S3226/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S3226/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4860",
    "lat": 26.335758,
    "lng": 127.799562,
    "name": "ミュージックタウン",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4860/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4860/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4840",
    "lat": 26.34363,
    "lng": 127.805562,
    "name": "嘉間良2丁目",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4840/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4840/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4853",
    "lat": 26.341234,
    "lng": 127.80908,
    "name": "仲松商事　前",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4853/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4853/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4830",
    "lat": 26.34091,
    "lng": 127.798783,
    "name": "BCコザ　(市立図書館)",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4830/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4830/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S4839",
    "lat": 26.343746,
    "lng": 127.799801,
    "name": "沖縄市民会館",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S4839/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S4839/timetable",
        "rel": "timetable"
      }
    ]
  },
  {
    "id": "S3911",
    "lat": 26.333634,
    "lng": 127.798715,
    "name": "中の町",
    "links": [
      {
        "href": "https://api.ottop.org/transit/stops/S3911/routes",
        "rel": "routes"
      },
      {
        "href": "https://api.ottop.org/transit/stops/S3911/timetable",
        "rel": "timetable"
      }
    ]
  }
]
'
		console.log('length: ' + data.length + ', ' + data);
		const obj = JSON.parse(data);
		console.log(obj.length);
			
		for (let el of obj) {
			console.log(el.name);
      		}

	}, function() {
		alert("現在位置に取得に失敗！")
	})
}

</script>
<style>

body { margin: 0; font-family: sans-serif; text-align: center; }
h1 { font-size: 5vw; margin: 0; }
#mapid { height: 60vh; }

</style></head><body>

<h1>Startup Lab Lagoon</h1>
<div id="mapid"></div>

<img id=qrcode><script>addEventListener("load", () => qrcode.src = "https://chart.apis.google.com/chart?chs=140x140&cht=qr&chl=" + encodeURIComponent(document.location))</script><br>
</body></html>
